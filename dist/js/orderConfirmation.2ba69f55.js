"use strict";(self["webpackChunkshengxian"]=self["webpackChunkshengxian"]||[]).push([[32],{8499:function(s,t,e){var n=e(65),r=e(60);const a=()=>{const s=(0,n.oR)(),t=async t=>{const e=s.state.addressList;if(t||!e.length){const t=await(0,r.U2)("/api/user/address");t?.data?.length&&s.commit("changeAddressList",t.data)}};return{getAddressList:t}};t["Z"]=a},3229:function(s,t,e){e.d(t,{r:function(){return a}});var n=e(65),r=e(3396);const a=s=>{const t=(0,n.oR)(),e=t.state.cartList,a=(s,e,n,r)=>{t.commit("changeCartItemInfo",{shopId:s,productId:e,productInfo:n,num:r})},c=(0,r.Fl)((()=>{const t=e[s]?.productList||{},n={};for(let s in t){const e=t[s];e.count>0&&(n[s]=e)}return n})),o=(0,r.Fl)((()=>{const t=e[s]?.shopName||[];return t})),d=(0,r.Fl)((()=>{const t=e[s]?.productList,n={total:0,price:0,allChecked:!0};if(t)for(let s in t){const e=t[s];n.total+=e.count,e.check&&(n.price+=e.count*e.price),e.count>0&&!e.check&&(n.allChecked=!1)}return n.price=n.price.toFixed(2),n}));return{changeCartItemInfo:a,cartList:e,productList:c,shopName:o,calculations:d}}},8862:function(s,t,e){e.r(t),e.d(t,{default:function(){return ls}});var n=e(3396);const r={class:"wrapper"};function a(s,t,e,a,c,o){const d=(0,n.up)("TopArea"),i=(0,n.up)("ProductList"),_=(0,n.up)("Order");return(0,n.wg)(),(0,n.iD)("div",r,[(0,n.Wm)(d),(0,n.Wm)(i),(0,n.Wm)(_)])}var c=e(8499),o=e(7139);const d=s=>((0,n.dD)("data-v-0f7b32ea"),s=s(),(0,n.Cn)(),s),i={class:"top"},_=d((()=>(0,n._)("div",{class:"top__bgcolor"},null,-1))),l={class:"top__header"},p={class:"top__receiver"},u=d((()=>(0,n._)("div",{class:"top__receiver__title"},"收货地址",-1))),m={class:"top__receiver__address"},h={class:"top__receiver__info"},v={class:"top__receiver__info__name"},f={class:"top__receiver__info__name"},k=d((()=>(0,n._)("div",{class:"top__receiver__icon iconfont"},"",-1))),C={key:1},w=d((()=>(0,n._)("div",{class:"top__receiver__address"}," 暂无可用地址 ",-1))),g=[w];function L(s,t,e,r,a,c){return(0,n.wg)(),(0,n.iD)("div",i,[_,(0,n._)("div",l,[(0,n._)("div",{class:"iconfont top__header__back",onClick:t[0]||(t[0]=(...s)=>r.handleBackClick&&r.handleBackClick(...s))},"  "),(0,n.Uk)(" 确认订单 ")]),(0,n._)("div",p,[u,r.address?((0,n.wg)(),(0,n.iD)("div",{key:0,onClick:t[1]||(t[1]=(...s)=>r.handleAddressClick&&r.handleAddressClick(...s))},[(0,n._)("div",m,(0,o.zw)(r.address.city)+(0,o.zw)(r.address.department)+(0,o.zw)(r.address.houseNumber),1),(0,n._)("div",h,[(0,n._)("span",v,(0,o.zw)(r.address.name),1),(0,n._)("span",f,(0,o.zw)(r.address.phone),1)]),k])):((0,n.wg)(),(0,n.iD)("div",C,g))])])}e(7658);var b=e(2483),y=e(65);const I=()=>{const s=(0,b.yj)(),t=s.params.addressId,e=(0,n.Fl)((()=>{const s=(0,y.oR)(),e=s.state.addressList;return e.find((s=>s._id===t))||e[0]}));return e};var D=I,z={name:"TopArea",setup(){const s=(0,b.tv)(),t=(0,b.yj)(),e=t.params.id,n=()=>{s.back()},r=()=>{s.push(`/chooseAddressList/${e}`)},a=D();return{handleBackClick:n,handleAddressClick:r,address:a}}},A=e(89);const O=(0,A.Z)(z,[["render",L],["__scopeId","data-v-0f7b32ea"]]);var N=O;const F=s=>((0,n.dD)("data-v-25080030"),s=s(),(0,n.Cn)(),s),U={class:"products"},Z={class:"products__title"},x={class:"products__wrapper"},S={class:"products__list"},j=["src"],R={class:"products__item__detail"},B={class:"products__item__title"},H={class:"products__item__price"},P=F((()=>(0,n._)("span",{class:"products__item__yen"},"¥",-1))),T={class:"products__item__total"},W=F((()=>(0,n._)("span",{class:"products__item__yen"},"¥",-1)));function Y(s,t,e,r,a,c){return(0,n.wg)(),(0,n.iD)("div",U,[(0,n._)("div",Z,(0,o.zw)(r.shopName),1),(0,n._)("div",x,[(0,n._)("div",S,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.productList,(s=>((0,n.wg)(),(0,n.iD)("div",{key:s._id,class:"products__item"},[(0,n._)("img",{class:"products__item__img",src:s.imgUrl},null,8,j),(0,n._)("div",R,[(0,n._)("h4",B,(0,o.zw)(s.name),1),(0,n._)("p",H,[(0,n._)("span",null,[P,(0,n.Uk)(" "+(0,o.zw)(s.price)+"x"+(0,o.zw)(s.count),1)]),(0,n._)("span",T,[W,(0,n.Uk)(" "+(0,o.zw)((s.price*s.count).toFixed(2)),1)])])])])))),128))])])])}var q=e(3229),K={name:"ProductList",setup(){const s=(0,b.yj)(),t=s.params.id,{shopName:e,productList:n}=(0,q.r)(t);return{productList:n,shopName:e}}};const M=(0,A.Z)(K,[["render",Y],["__scopeId","data-v-25080030"]]);var $=M,E=e(9242);const G=s=>((0,n.dD)("data-v-8202a754"),s=s(),(0,n.Cn)(),s),J={class:"order"},Q={class:"order__price"},V=G((()=>(0,n._)("h3",{class:"mask__content__title"},"确认要离开收银台？",-1))),X=G((()=>(0,n._)("p",{class:"mask__content__desc"},"请尽快完成支付，否则将被取消",-1))),ss={class:"mask__content__btns"};function ts(s,t,e,r,a,c){return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",J,[(0,n._)("div",Q,[(0,n.Uk)(" 实付金额"),(0,n._)("b",null,"￥"+(0,o.zw)(r.calculations.price),1)]),r.address?((0,n.wg)(),(0,n.iD)("div",{key:0,class:"order__btn",onClick:t[0]||(t[0]=()=>r.handleShowConfirmChange(!0))}," 提交订单 ")):(0,n.kq)("",!0)]),(0,n.wy)((0,n._)("div",{class:"mask",onClick:t[4]||(t[4]=()=>r.handleShowConfirmChange(!1))},[(0,n._)("div",{class:"mask__content",onClick:t[3]||(t[3]=(0,E.iM)((()=>{}),["stop"]))},[V,X,(0,n._)("div",ss,[(0,n._)("div",{class:"mask__content__btn mask__content__btn--first",onClick:t[1]||(t[1]=()=>r.handleConfirmOrder(!0))}," 取消订单 "),(0,n._)("div",{class:"mask__content__btn mask__content__btn--last",onClick:t[2]||(t[2]=()=>r.handleConfirmOrder(!1))}," 确认支付 ")])])],512),[[E.F8,r.showConfirm]])],64)}var es=e(4870),ns=e(60);const rs=(s,t,e,n)=>{const r=(0,b.tv)(),a=(0,y.oR)(),c=async c=>{const o=[];for(let s in t.value){const e=t.value[s];o.push({id:e._id,num:e.count})}try{const t=await(0,ns.v_)("/api/order",{addressId:n.value._id,shopId:s,shopName:e.value,isCanceled:c,products:o});0===t?.errno&&(a.commit("clearCartData",s),r.push({name:"OrderList"}))}catch(d){}};return{handleConfirmOrder:c}},as=()=>{const s=(0,es.iH)(!1),t=t=>{s.value=t};return{showConfirm:s,handleShowConfirmChange:t}};var cs={name:"Order",setup(){const s=(0,b.yj)(),t=s.params.id,e=D(),{calculations:n,shopName:r,productList:a}=(0,q.r)(t),{handleConfirmOrder:c}=rs(t,a,r,e),{showConfirm:o,handleShowConfirmChange:d}=as();return{address:e,calculations:n,handleConfirmOrder:c,showConfirm:o,handleShowConfirmChange:d}}};const os=(0,A.Z)(cs,[["render",ts],["__scopeId","data-v-8202a754"]]);var ds=os,is={name:"OrderConfirmation",components:{TopArea:N,ProductList:$,Order:ds},setup(){const{getAddressList:s}=(0,c.Z)();s()}};const _s=(0,A.Z)(is,[["render",a],["__scopeId","data-v-4bfdb682"]]);var ls=_s}}]);
//# sourceMappingURL=orderConfirmation.2ba69f55.js.map