{"version":3,"file":"js/orderConfirmation.2ba69f55.js","mappings":"oIAGA,MAAMA,EAAyBA,KAC7B,MAAMC,GAAQC,EAAAA,EAAAA,MAERC,EAAiBC,UACrB,MAAMC,EAAcJ,EAAMK,MAAMD,YAChC,GAAGE,IAAgBF,EAAYG,OAAQ,CACrC,MAAMC,QAAeC,EAAAA,EAAAA,IAAI,qBACtBD,GAAQE,MAAMH,QACfP,EAAMW,OAAO,oBAAqBH,EAAOE,KAE7C,GAGF,MAAO,CAAER,iBAAgB,EAG3B,Q,6ECfO,MAAMU,EAAuBC,IAChC,MAAMb,GAAQC,EAAAA,EAAAA,MACRa,EAAWd,EAAMK,MAAMS,SACvBC,EAAqBA,CAACF,EAAQG,EAAWC,EAAaC,KACxDlB,EAAMW,OAAO,qBAAsB,CAC/BE,SACAG,YACAC,cACAC,OACF,EAEAC,GAAcC,EAAAA,EAAAA,KAAS,KACzB,MAAMD,EAAcL,EAASD,IAASM,aAAe,CAAC,EAEhDE,EAAqB,CAAC,EAC5B,IAAK,IAAIC,KAAKH,EAAa,CACvB,MAAMI,EAAUJ,EAAYG,GACxBC,EAAQC,MAAQ,IAChBH,EAAmBC,GAAKC,EAEhC,CAEA,OAAOF,CAAkB,IAEvBI,GAAWL,EAAAA,EAAAA,KAAS,KACtB,MAAMK,EAAWX,EAASD,IAASY,UAAY,GAC/C,OAAOA,CAAQ,IAEbC,GAAeN,EAAAA,EAAAA,KAAS,KAC1B,MAAMD,EAAcL,EAASD,IAASM,YAChCX,EAAS,CAAEmB,MAAO,EAAGC,MAAO,EAAGC,YAAY,GACjD,GAAIV,EACA,IAAK,IAAIG,KAAKH,EAAa,CACvB,MAAMI,EAAUJ,EAAYG,GAE5Bd,EAAOmB,OAASJ,EAAQC,MAEpBD,EAAQO,QACRtB,EAAOoB,OAASL,EAAQC,MAAQD,EAAQK,OAExCL,EAAQC,MAAQ,IAAMD,EAAQO,QAC9BtB,EAAOqB,YAAa,EAE5B,CAGJ,OADArB,EAAOoB,MAAQpB,EAAOoB,MAAMG,QAAQ,GAC7BvB,CAAM,IAEjB,MAAO,CAAEO,qBAAoBD,WAAUK,cAAaM,WAAUC,eAAc,C,4FCnDzEM,MAAM,W,oHAAXC,EAAAA,EAAAA,IAIM,MAJNC,EAIM,EAHJC,EAAAA,EAAAA,IAAWC,IACXD,EAAAA,EAAAA,IAAeE,IACfF,EAAAA,EAAAA,IAASG,I,wFCHNN,MAAM,O,UACTO,EAAAA,EAAAA,GAAgC,OAA3BP,MAAM,gBAAc,W,GACpBA,MAAM,e,GAMNA,MAAM,iB,UACTO,EAAAA,EAAAA,GAA4C,OAAvCP,MAAM,wBAAuB,QAAI,K,GAE/BA,MAAM,0B,GAGNA,MAAM,uB,GACHA,MAAM,6B,GACNA,MAAM,6B,UAEdO,EAAAA,EAAAA,GAAwD,OAAnDP,MAAM,gCAA+B,KAAQ,K,oBAGlDO,EAAAA,EAAAA,GAEM,OAFDP,MAAM,0BAAyB,YAEpC,K,GAFAQ,G,0CArBNP,EAAAA,EAAAA,IA0BM,MA1BNC,EA0BM,CAzBJO,GACAF,EAAAA,EAAAA,GAKM,MALNG,EAKM,EAJJH,EAAAA,EAAAA,GAEM,OAFDP,MAAM,6BAA8BW,QAAKC,EAAA,KAAAA,EAAA,OAAAC,IAAEC,EAAAC,iBAAAD,EAAAC,mBAAAF,KAAiB,QAEjE,QAAM,aAGRN,EAAAA,EAAAA,GAiBM,MAjBNS,EAiBM,CAhBJC,EACWH,EAAAI,UAAO,WAAlBjB,EAAAA,EAAAA,IASM,O,MATeU,QAAKC,EAAA,KAAAA,EAAA,OAAAC,IAAEC,EAAAK,oBAAAL,EAAAK,sBAAAN,K,EAC1BN,EAAAA,EAAAA,GAEM,MAFNa,GAEMC,EAAAA,EAAAA,IADDP,EAAAI,QAAQI,OAAID,EAAAA,EAAAA,IAAMP,EAAAI,QAAQK,aAAUF,EAAAA,EAAAA,IAAMP,EAAAI,QAAQM,aAAW,IAElEjB,EAAAA,EAAAA,GAGM,MAHNkB,EAGM,EAFJlB,EAAAA,EAAAA,GAAiE,OAAjEmB,GAAiEL,EAAAA,EAAAA,IAAtBP,EAAAI,QAAQS,MAAI,IACvDpB,EAAAA,EAAAA,GAAkE,OAAlEqB,GAAkEP,EAAAA,EAAAA,IAAvBP,EAAAI,QAAQW,OAAK,KAE1DC,OAAwD,WAE1D7B,EAAAA,EAAAA,IAIM,MAAA8B,EAAAC,O,+BCrBZ,MAAMC,EAAmBA,KACvB,MAAMC,GAAQC,EAAAA,EAAAA,MACRC,EAAYF,EAAMG,OAAOD,UACzBE,GAAiBlD,EAAAA,EAAAA,KAAS,KAC9B,MAAMpB,GAAQC,EAAAA,EAAAA,MACRG,EAAcJ,EAAMK,MAAMD,YAChC,OAAOA,EAAYmE,MAAKC,GAAQA,EAAKC,MAAQL,KAAchE,EAAY,EAAE,IAE3E,OAAOkE,CAAc,EAGvB,QDmBA,GACEX,KAAM,UACNe,QACE,MAAMC,GAASC,EAAAA,EAAAA,MACTV,GAAQC,EAAAA,EAAAA,MACRtD,EAASqD,EAAMG,OAAOQ,GACtB9B,EAAkBA,KACtB4B,EAAOG,MAAM,EAET3B,EAAqBA,KACzBwB,EAAOI,KAAM,sBAAqBlE,IAAS,EAEvCqC,EAAUe,IAChB,MAAO,CAAElB,kBAAiBI,qBAAoBD,UAChD,G,QEzCF,MAAM8B,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAAS,GAAQ,CAAC,YAAY,qBAEzF,Q,+DCROhD,MAAM,Y,GACJA,MAAM,mB,GACNA,MAAM,qB,GACJA,MAAM,kB,aAGFA,MAAM,0B,GACLA,MAAM,yB,GACPA,MAAM,yB,UAELO,EAAAA,EAAAA,GAA8C,QAAxCP,MAAM,uBAAsB,KAAK,K,GAGnCA,MAAM,yB,UACVO,EAAAA,EAAAA,GAA8C,QAAxCP,MAAM,uBAAsB,KAAK,K,0CAdrDC,EAAAA,EAAAA,IAsBM,MAtBNC,EAsBM,EArBJK,EAAAA,EAAAA,GAAiD,MAAjDE,GAAiDY,EAAAA,EAAAA,IAAjBP,EAAArB,UAAQ,IACxCc,EAAAA,EAAAA,GAmBM,MAnBNG,EAmBM,EAlBJH,EAAAA,EAAAA,GAiBM,MAjBNS,EAiBM,gBAhBJf,EAAAA,EAAAA,IAeMgD,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAfcpC,EAAA3B,aAARqD,K,WAAZvC,EAAAA,EAAAA,IAeM,OAf4BkD,IAAKX,EAAKC,IAAKzC,MAAM,kB,EACrDO,EAAAA,EAAAA,GAAsD,OAAjDP,MAAM,sBAAuBoD,IAAKZ,EAAKa,Q,WAC5C9C,EAAAA,EAAAA,GAYM,MAZNa,EAYM,EAXJb,EAAAA,EAAAA,GAAsD,KAAtDkB,GAAsDJ,EAAAA,EAAAA,IAAjBmB,EAAKb,MAAI,IAC9CpB,EAAAA,EAAAA,GASI,IATJmB,EASI,EARFnB,EAAAA,EAAAA,GAGO,aAFLqB,GAA8C,aAC9CP,EAAAA,EAAAA,IAAGmB,EAAK5C,OAAQ,KAACyB,EAAAA,EAAAA,IAAGmB,EAAKhD,OAAK,MAEhCe,EAAAA,EAAAA,GAGO,OAHPuB,EAGO,CAFLC,GAA8C,aAC9CV,EAAAA,EAAAA,KAAImB,EAAK5C,MAAQ4C,EAAKhD,OAAOO,QAAQ,IAAD,c,0BAapD,GACE4B,KAAM,cACNe,QACE,MAAMR,GAAQC,EAAAA,EAAAA,MACRtD,EAASqD,EAAMG,OAAOQ,IACtB,SAAEpD,EAAQ,YAAEN,IAAgBP,EAAAA,EAAAA,GAAoBC,GACtD,MAAO,CAAEM,cAAaM,WACxB,GC7BF,MAAM,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAAS,GAAQ,CAAC,YAAY,qBAEzF,Q,yECROO,MAAM,S,GACJA,MAAM,gB,UAaTO,EAAAA,EAAAA,GAA+C,MAA3CP,MAAM,wBAAuB,aAAS,K,UAC1CO,EAAAA,EAAAA,GAAiD,KAA9CP,MAAM,uBAAsB,kBAAc,K,IACxCA,MAAM,uB,+DAhBfO,EAAAA,EAAAA,GAOM,MAPNL,EAOM,EANJK,EAAAA,EAAAA,GAEM,MAFNE,EAEM,UAFoB,UACpBF,EAAAA,EAAAA,GAAgC,SAA7B,KAACc,EAAAA,EAAAA,IAAGP,EAAApB,aAAaE,OAAK,KAEpBkB,EAAAI,UAAO,WAAlBjB,EAAAA,EAAAA,IAEM,O,MAFcD,MAAM,aAAcW,QAAKC,EAAA,KAAAA,EAAA,OAAQE,EAAAwC,yBAAwB,KAAO,YAEpF,2BAEF/C,EAAAA,EAAAA,GAuBM,OAtBJP,MAAM,OAELW,QAAKC,EAAA,KAAAA,EAAA,OAAQE,EAAAwC,yBAAwB,K,EAEtC/C,EAAAA,EAAAA,GAiBM,OAjBDP,MAAM,gBAAiBW,QAAKC,EAAA,KAAAA,EAAA,IAAA2C,EAAAA,EAAAA,KAAN,QAAW,Y,CACpC7C,EACAM,GACAT,EAAAA,EAAAA,GAaM,MAbNU,GAaM,EAZJV,EAAAA,EAAAA,GAKM,OAJJP,MAAM,+CACLW,QAAKC,EAAA,KAAAA,EAAA,OAAQE,EAAA0C,oBAAmB,KAClC,WAGDjD,EAAAA,EAAAA,GAKM,OAJJP,MAAM,8CACLW,QAAKC,EAAA,KAAAA,EAAA,OAAQE,EAAA0C,oBAAmB,KAClC,eAED,YAlBI1C,EAAA2C,gBAAW,G,yBAmCvB,MAAMC,GAAqBA,CAAC7E,EAAQM,EAAaM,EAASyB,KACxD,MAAMyB,GAASC,EAAAA,EAAAA,MACT5E,GAAQC,EAAAA,EAAAA,MACRuF,EAAqBrF,UACzB,MAAMwF,EAAW,GACjB,IAAK,IAAIrE,KAAKH,EAAYyE,MAAO,CAC/B,MAAMrE,EAAUJ,EAAYyE,MAAMtE,GAClCqE,EAASZ,KAAK,CAAEF,GAAItD,EAAQkD,IAAKvD,IAAKK,EAAQC,OAChD,CAEA,IACE,MAAMhB,QAAeqF,EAAAA,GAAAA,IAAK,aAAc,CACtCzB,UAAWlB,EAAQ0C,MAAMnB,IACzB5D,SACAY,SAAUA,EAASmE,MACnBE,aACAH,aAGoB,IAAlBnF,GAAQuF,QACV/F,EAAMW,OAAO,gBAAiBE,GAC9B8D,EAAOI,KAAK,CAAEpB,KAAM,cAExB,CAAE,MAAOqC,GACP,GAGJ,MAAO,CAAER,qBAAoB,EAGzBS,GAAoBA,KAExB,MAAMR,GAAcS,EAAAA,GAAAA,KAAI,GAClBZ,EAA2Ba,IAC/BV,EAAYG,MAAQO,CAAM,EAE5B,MAAO,CAAEV,cAAYH,0BAAyB,EAGhD,QACE3B,KAAM,QACNe,QACE,MAAMR,GAAQC,EAAAA,EAAAA,MACRtD,EAASqD,EAAMG,OAAOQ,GACtB3B,EAAQe,KACR,aAAEvC,EAAY,SAAED,EAAQ,YAAEN,IAAgBP,EAAAA,EAAAA,GAAoBC,IAE9D,mBAAE2E,GAAuBE,GAC7B7E,EACAM,EACAM,EACAyB,IAEI,YAACuC,EAAW,wBAAEH,GAA4BW,KAEhD,MAAO,CACL/C,UACAxB,eACA8D,qBACAC,cACAH,0BAEJ,GCrGF,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UPKA,IACE3B,KAAM,oBACNyC,WAAY,CAAEC,QAAO,EAACC,YAAW,EAACC,MAAKA,IACvC7B,QACE,MAAM,eAACxE,IAAgBH,EAAAA,EAAAA,KACvBG,GACF,GQbF,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAASsG,GAAQ,CAAC,YAAY,qBAEzF,S","sources":["webpack://shengxian/./src/effects/addressEffect.js","webpack://shengxian/./src/effects/cartEffects.js","webpack://shengxian/./src/views/orderConfirmation/OrderConfirmation.vue","webpack://shengxian/./src/views/orderConfirmation/TopArea.vue","webpack://shengxian/./src/views/orderConfirmation/addressEffect.js","webpack://shengxian/./src/views/orderConfirmation/TopArea.vue?5803","webpack://shengxian/./src/views/orderConfirmation/ProductList.vue","webpack://shengxian/./src/views/orderConfirmation/ProductList.vue?54f6","webpack://shengxian/./src/views/orderConfirmation/Order.vue","webpack://shengxian/./src/views/orderConfirmation/Order.vue?af59","webpack://shengxian/./src/views/orderConfirmation/OrderConfirmation.vue?bcaf"],"sourcesContent":["import { useStore } from 'vuex'\r\nimport { get } from '../utils/request'\r\n\r\nconst useCommonAddressEffect = () => {\r\n  const store = useStore()\r\n\r\n  const getAddressList = async (forceUpdate) => {\r\n    const addressList = store.state.addressList;\r\n    if(forceUpdate || !addressList.length) {\r\n      const result = await get('/api/user/address')\r\n      if(result?.data?.length) {\r\n        store.commit('changeAddressList', result.data)\r\n      }\r\n    }\r\n  }\r\n\r\n  return { getAddressList }\r\n}\r\n\r\nexport default useCommonAddressEffect","import { useStore } from \"vuex\";\r\nimport { computed } from \"vue\";\r\n\r\n//购物车相关逻辑\r\nexport const useCommonCartEffect = (shopId) => {\r\n    const store = useStore();\r\n    const cartList = store.state.cartList\r\n    const changeCartItemInfo = (shopId, productId, productInfo, num) => {\r\n        store.commit(\"changeCartItemInfo\", {\r\n            shopId,\r\n            productId,\r\n            productInfo,\r\n            num\r\n        });\r\n    };\r\n    const productList = computed(() => {\r\n        const productList = cartList[shopId]?.productList || {};\r\n        // console.log(productList)\r\n        const notEmtyProductList = {}\r\n        for (let i in productList) {\r\n            const product = productList[i]\r\n            if (product.count > 0) {\r\n                notEmtyProductList[i] = product\r\n            }\r\n        }\r\n        // console.log(notEmtyProductList)\r\n        return notEmtyProductList;\r\n    });\r\n    const shopName = computed(() => {\r\n        const shopName = cartList[shopId]?.shopName || [];\r\n        return shopName;\r\n    });\r\n    const calculations = computed(() => {\r\n        const productList = cartList[shopId]?.productList;\r\n        const result = { total: 0, price: 0, allChecked: true };\r\n        if (productList) {\r\n            for (let i in productList) {\r\n                const product = productList[i];\r\n                //计算购物车上的件数\r\n                result.total += product.count;\r\n                //计算总计价格\r\n                if (product.check) {\r\n                    result.price += product.count * product.price;\r\n                }\r\n                if (product.count > 0 && !product.check) {\r\n                    result.allChecked = false;\r\n                }\r\n            }\r\n        }\r\n        result.price = result.price.toFixed(2);\r\n        return result;\r\n    });\r\n    return { changeCartItemInfo, cartList, productList, shopName, calculations };\r\n};","<template>\r\n  <div class=\"wrapper\">\r\n    <TopArea />\r\n    <ProductList />\r\n    <Order />\r\n  </div>\r\n</template>\r\n    \r\n<script>\r\nimport useCommonAddressEffect from '../../effects/addressEffect'\r\nimport TopArea from \"./TopArea.vue\";\r\nimport ProductList from \"./ProductList.vue\";\r\nimport Order from \"./Order.vue\";\r\n\r\nexport default {\r\n  name: \"OrderConfirmation\",\r\n  components: { TopArea,ProductList,Order },\r\n  setup(){\r\n    const {getAddressList}=useCommonAddressEffect()\r\n    getAddressList()\r\n  }\r\n};\r\n</script>\r\n\r\n\r\n<style lang=\"scss\" scoped>\r\n.wrapper {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  top: 0;\r\n  bottom: 0;\r\n  background-color: #eee;\r\n  overflow-y: scroll;\r\n}\r\n\r\n\r\n\r\n</style>","<template>\r\n  <div class=\"top\">\r\n    <div class=\"top__bgcolor\"></div>\r\n    <div class=\"top__header\">\r\n      <div class=\"iconfont top__header__back\" @click=\"handleBackClick\">\r\n        &#xe6db;\r\n      </div>\r\n      确认订单\r\n    </div>\r\n    <div class=\"top__receiver\">\r\n      <div class=\"top__receiver__title\">收货地址</div>\r\n      <div v-if=\"address\" @click=\"handleAddressClick\">\r\n        <div class=\"top__receiver__address\">\r\n          {{ address.city }}{{ address.department }}{{ address.houseNumber }}\r\n        </div>\r\n        <div class=\"top__receiver__info\">\r\n          <span class=\"top__receiver__info__name\">{{ address.name }}</span>\r\n          <span class=\"top__receiver__info__name\">{{ address.phone }}</span>\r\n        </div>\r\n        <div class=\"top__receiver__icon iconfont\">&#xe6db;</div>\r\n      </div>\r\n      <div v-else>\r\n        <div class=\"top__receiver__address\">\r\n          暂无可用地址\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n    \r\n\r\n<script>\r\nimport { useRoute, useRouter } from \"vue-router\";\r\nimport useAddressEffect from \"./addressEffect\";\r\nexport default {\r\n  name: \"TopArea\",\r\n  setup() {\r\n    const router = useRouter();\r\n    const route = useRoute();\r\n    const shopId = route.params.id;\r\n    const handleBackClick = () => {\r\n      router.back();\r\n    };\r\n    const handleAddressClick = () => {\r\n      router.push(`/chooseAddressList/${shopId}`);\r\n    };\r\n    const address = useAddressEffect();\r\n    return { handleBackClick, handleAddressClick, address };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import \"../../style/viriables.scss\";\r\n.top {\r\n  position: relative;\r\n  height: 1.96rem;\r\n  background-size: 100% 1.59rem;\r\n  background-image: linear-gradient(\r\n    0deg,\r\n    rgba(0, 145, 255, 0) 4%,\r\n    $btn-bgColor 50%\r\n  );\r\n  background-repeat: no-repeat;\r\n  &__header {\r\n    position: relative;\r\n    padding-top: 0.2rem;\r\n    line-height: 0.24rem;\r\n    color: $bgColor;\r\n    text-align: center;\r\n    font-size: 0.16rem;\r\n    &__back {\r\n      position: absolute;\r\n      left: 0.18rem;\r\n      font-size: 0.22rem;\r\n    }\r\n  }\r\n  &__receiver {\r\n    position: absolute;\r\n    left: 0.18rem;\r\n    right: 0.18rem;\r\n    bottom: 0;\r\n    height: 1.11rem;\r\n    background: $bgColor;\r\n    border-radius: 0.04rem;\r\n    &__title {\r\n      line-height: 0.22rem;\r\n      padding: 0.16rem 0 0.14rem 0.16rem;\r\n      font-size: 0.16rem;\r\n      color: $content-fontcolor;\r\n    }\r\n    &__address {\r\n      line-height: 0.2rem;\r\n      padding: 0 0.4rem 0 0.16rem;\r\n      font-size: 0.14rem;\r\n      color: $content-fontcolor;\r\n    }\r\n    &__info {\r\n      padding: 0.06rem 0 0 0.16rem;\r\n      &__name {\r\n        margin-right: 0.06rem;\r\n        line-height: 0.18rem;\r\n        font-size: 0.12rem;\r\n        color: $medium-fontColor;\r\n      }\r\n    }\r\n    &__icon {\r\n      transform: rotate(180deg);\r\n      position: absolute;\r\n      right: 0.16rem;\r\n      top: 0.5rem;\r\n      color: $medium-fontColor;\r\n      font-size: 0.2rem;\r\n    }\r\n  }\r\n}\r\n</style>","import { computed } from 'vue'\r\nimport { useRoute } from 'vue-router'\r\nimport { useStore } from 'vuex'\r\n\r\nconst useAddressEffect = () => {\r\n  const route = useRoute()\r\n  const addressId = route.params.addressId\r\n  const currentAddress = computed(() => {\r\n    const store = useStore()\r\n    const addressList = store.state.addressList\r\n    return addressList.find(item => item._id === addressId) || addressList[0]\r\n  })\r\n  return currentAddress\r\n}\r\n\r\nexport default useAddressEffect","import { render } from \"./TopArea.vue?vue&type=template&id=0f7b32ea&scoped=true\"\nimport script from \"./TopArea.vue?vue&type=script&lang=js\"\nexport * from \"./TopArea.vue?vue&type=script&lang=js\"\n\nimport \"./TopArea.vue?vue&type=style&index=0&id=0f7b32ea&lang=scss&scoped=true\"\n\nimport exportComponent from \"F:\\\\Web2022\\\\shengxian\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0f7b32ea\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"products\">\r\n    <div class=\"products__title\">{{ shopName }}</div>\r\n    <div class=\"products__wrapper\">\r\n      <div class=\"products__list\">\r\n        <div v-for=\"item in productList\" :key=\"item._id\" class=\"products__item\">\r\n          <img class=\"products__item__img\" :src=\"item.imgUrl\" />\r\n          <div class=\"products__item__detail\">\r\n            <h4 class=\"products__item__title\">{{ item.name }}</h4>\r\n            <p class=\"products__item__price\">\r\n              <span>\r\n                <span class=\"products__item__yen\">&yen;</span>\r\n                {{ item.price }}x{{ item.count }}\r\n              </span>\r\n              <span class=\"products__item__total\">\r\n                <span class=\"products__item__yen\">&yen;</span>\r\n                {{ (item.price * item.count).toFixed(2) }}\r\n              </span>\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useRoute } from \"vue-router\";\r\nimport { useCommonCartEffect } from \"../../effects/cartEffects\";\r\nexport default {\r\n  name: \"ProductList\",\r\n  setup() {\r\n    const route = useRoute();\r\n    const shopId = route.params.id;\r\n    const { shopName, productList } = useCommonCartEffect(shopId);\r\n    return { productList, shopName };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import \"../../style/viriables.scss\";\r\n@import \"../../style/mixins.scss\";\r\n.products {\r\n  margin: 0.16rem 0.18rem 0.55rem 0.18rem;\r\n  background: $bgColor;\r\n  &__title {\r\n    padding: 0.16rem;\r\n    font-size: 0.16rem;\r\n    color: $content-fontcolor;\r\n  }\r\n  &__wrapper {\r\n    overflow-y: scroll;\r\n    margin: 0 0.18rem;\r\n    position: absolute;\r\n    right: 0;\r\n    left: 0;\r\n    bottom: 0.6rem;\r\n    top: 2.6rem;\r\n  }\r\n  &__list {\r\n    background: $bgColor;\r\n  }\r\n  &__item {\r\n    position: relative;\r\n    display: flex;\r\n    padding: 0 0.16rem 0.16rem 0.16rem;\r\n    &__img {\r\n      width: 0.46rem;\r\n      height: 0.46rem;\r\n      margin-right: 0.16rem;\r\n    }\r\n    &__detail {\r\n      flex: 1;\r\n    }\r\n\r\n    &__title {\r\n      margin: 0;\r\n      line-height: 0.2rem;\r\n      font-size: 0.14rem;\r\n      color: $content-fontcolor;\r\n      @include ellipsis;\r\n    }\r\n    &__price {\r\n      display: flex;\r\n      margin: 0.06rem 0 0 0;\r\n      line-height: 0.2rem;\r\n      font-size: 0.14rem;\r\n      color: $hightlight-fontColor;\r\n    }\r\n    &__total {\r\n      text-align: right;\r\n      flex: 1;\r\n      color: $dark-fontColor;\r\n    }\r\n    &__yen {\r\n      font-size: 0.12rem;\r\n    }\r\n  }\r\n}\r\n</style>","import { render } from \"./ProductList.vue?vue&type=template&id=25080030&scoped=true\"\nimport script from \"./ProductList.vue?vue&type=script&lang=js\"\nexport * from \"./ProductList.vue?vue&type=script&lang=js\"\n\nimport \"./ProductList.vue?vue&type=style&index=0&id=25080030&lang=scss&scoped=true\"\n\nimport exportComponent from \"F:\\\\Web2022\\\\shengxian\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-25080030\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"order\">\r\n    <div class=\"order__price\">\r\n      实付金额<b>￥{{ calculations.price }}</b>\r\n    </div>\r\n    <div v-if=\"address\" class=\"order__btn\" @click=\"() => handleShowConfirmChange(true)\">\r\n      提交订单\r\n    </div>\r\n  </div>\r\n  <div\r\n    class=\"mask\"\r\n    v-show=\"showConfirm\"\r\n    @click=\"() => handleShowConfirmChange(false)\"\r\n  >\r\n    <div class=\"mask__content\" @click.stop>\r\n      <h3 class=\"mask__content__title\">确认要离开收银台？</h3>\r\n      <p class=\"mask__content__desc\">请尽快完成支付，否则将被取消</p>\r\n      <div class=\"mask__content__btns\">\r\n        <div\r\n          class=\"mask__content__btn mask__content__btn--first\"\r\n          @click=\"() => handleConfirmOrder(true)\"\r\n        >\r\n          取消订单\r\n        </div>\r\n        <div\r\n          class=\"mask__content__btn mask__content__btn--last\"\r\n          @click=\"() => handleConfirmOrder(false)\"\r\n        >\r\n          确认支付\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n\r\n\r\n<script>\r\nimport { ref } from \"vue\";\r\nimport { post } from \"../../utils/request\";\r\nimport { useStore } from \"vuex\";\r\nimport { useRoute, useRouter } from \"vue-router\";\r\nimport { useCommonCartEffect } from \"../../effects/cartEffects\";\r\nimport useAddressEffect from './addressEffect'\r\n\r\n//下单相关逻辑\r\nconst useMakeOrderEffect = (shopId, productList, shopName,address) => {\r\n  const router = useRouter();\r\n  const store = useStore();\r\n  const handleConfirmOrder = async (isCanceled) => {\r\n    const products = [];\r\n    for (let i in productList.value) {\r\n      const product = productList.value[i];\r\n      products.push({ id: product._id, num: product.count });\r\n    }\r\n    //   console.log(products);\r\n    try {\r\n      const result = await post(\"/api/order\", {\r\n        addressId: address.value._id,\r\n        shopId,\r\n        shopName: shopName.value,\r\n        isCanceled,\r\n        products,\r\n      });\r\n      // console.log(result);\r\n      if (result?.errno === 0) {\r\n        store.commit(\"clearCartData\", shopId);\r\n        router.push({ name: \"OrderList\" });\r\n      }\r\n    } catch (e) {\r\n      //提示下单失败\r\n    }\r\n  };\r\n  return { handleConfirmOrder };\r\n};\r\n//蒙层展示相关的逻辑\r\nconst useShowMaskEffect = () => {\r\n    // console.log(status)\r\n  const showConfirm = ref(false);\r\n  const handleShowConfirmChange = (status) => {\r\n    showConfirm.value = status;\r\n  };\r\n  return { showConfirm,handleShowConfirmChange };\r\n};\r\n\r\nexport default {\r\n  name: \"Order\",\r\n  setup() {\r\n    const route = useRoute();\r\n    const shopId = route.params.id;\r\n    const address=useAddressEffect()\r\n    const { calculations, shopName, productList } = useCommonCartEffect(shopId);\r\n\r\n    const { handleConfirmOrder } = useMakeOrderEffect(\r\n      shopId,\r\n      productList,\r\n      shopName,\r\n      address\r\n    );\r\n    const {showConfirm, handleShowConfirmChange } = useShowMaskEffect();\r\n\r\n    return {\r\n      address,\r\n      calculations,\r\n      handleConfirmOrder,\r\n      showConfirm,\r\n      handleShowConfirmChange,\r\n    };\r\n  },\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n@import \"../../style/viriables.scss\";\r\n.order {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  display: flex;\r\n  height: 0.49rem;\r\n  line-height: 0.49rem;\r\n  background: $bgColor;\r\n  &__price {\r\n    flex: 1;\r\n    text-indent: 0.24rem;\r\n    font-size: 0.14rem;\r\n    color: $content-fontcolor;\r\n  }\r\n  &__btn {\r\n    width: 0.98rem;\r\n    background: #4fb0f9;\r\n    color: $bgColor;\r\n    font-size: 0.14rem;\r\n    text-align: center;\r\n  }\r\n}\r\n.mask {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  top: 0;\r\n  z-index: 1;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  &__content {\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    width: 3rem;\r\n    height: 1.56rem;\r\n    background: $bgColor;\r\n    border-radius: 0.04rem;\r\n    text-align: center;\r\n    &__title {\r\n      margin: 0.24rem 0 0 0;\r\n      line-height: 0.26rem;\r\n      font-size: 0.18rem;\r\n      color: $content-fontcolor;\r\n    }\r\n    &__desc {\r\n      margin: 0.08rem 0 0 0;\r\n      font-size: 0.14rem;\r\n      color: $medium-fontColor;\r\n    }\r\n    &__btns {\r\n      display: flex;\r\n      margin: 0.24rem 0.58rem 0 0.58rem;\r\n    }\r\n    &__btn {\r\n      flex: 1;\r\n      width: 0.8rem;\r\n      line-height: 0.32rem;\r\n      border-radius: 0.16rem;\r\n      border-radius: 0.16rem;\r\n      font-size: 0.14rem;\r\n      &--first {\r\n        margin-right: 0.12rem;\r\n        border: 0.01rem solid #4fb0f9;\r\n        color: #4fb0f9;\r\n      }\r\n      &--last {\r\n        margin-left: 0.12rem;\r\n        background: #4fb0f9;\r\n        color: $bgColor;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>","import { render } from \"./Order.vue?vue&type=template&id=8202a754&scoped=true\"\nimport script from \"./Order.vue?vue&type=script&lang=js\"\nexport * from \"./Order.vue?vue&type=script&lang=js\"\n\nimport \"./Order.vue?vue&type=style&index=0&id=8202a754&lang=scss&scoped=true\"\n\nimport exportComponent from \"F:\\\\Web2022\\\\shengxian\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-8202a754\"]])\n\nexport default __exports__","import { render } from \"./OrderConfirmation.vue?vue&type=template&id=4bfdb682&scoped=true\"\nimport script from \"./OrderConfirmation.vue?vue&type=script&lang=js\"\nexport * from \"./OrderConfirmation.vue?vue&type=script&lang=js\"\n\nimport \"./OrderConfirmation.vue?vue&type=style&index=0&id=4bfdb682&lang=scss&scoped=true\"\n\nimport exportComponent from \"F:\\\\Web2022\\\\shengxian\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4bfdb682\"]])\n\nexport default __exports__"],"names":["useCommonAddressEffect","store","useStore","getAddressList","async","addressList","state","forceUpdate","length","result","get","data","commit","useCommonCartEffect","shopId","cartList","changeCartItemInfo","productId","productInfo","num","productList","computed","notEmtyProductList","i","product","count","shopName","calculations","total","price","allChecked","check","toFixed","class","_createElementBlock","_hoisted_1","_createVNode","_component_TopArea","_component_ProductList","_component_Order","_createElementVNode","_hoisted_12","_hoisted_2","_hoisted_3","onClick","_cache","args","$setup","handleBackClick","_hoisted_4","_hoisted_5","address","handleAddressClick","_hoisted_6","_toDisplayString","city","department","houseNumber","_hoisted_7","_hoisted_8","name","_hoisted_9","phone","_hoisted_10","_hoisted_11","_hoisted_13","useAddressEffect","route","useRoute","addressId","params","currentAddress","find","item","_id","setup","router","useRouter","id","back","push","__exports__","_Fragment","_renderList","key","src","imgUrl","handleShowConfirmChange","_withModifiers","handleConfirmOrder","showConfirm","useMakeOrderEffect","products","value","post","isCanceled","errno","e","useShowMaskEffect","ref","status","components","TopArea","ProductList","Order","render"],"sourceRoot":""}