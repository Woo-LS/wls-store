"use strict";(self["webpackChunkshengxian"]=self["webpackChunkshengxian"]||[]).push([[523],{3229:function(t,c,a){a.d(c,{r:function(){return s}});var e=a(65),n=a(3396);const s=t=>{const c=(0,e.oR)(),a=c.state.cartList,s=(t,a,e,n)=>{c.commit("changeCartItemInfo",{shopId:t,productId:a,productInfo:e,num:n})},o=(0,n.Fl)((()=>{const c=a[t]?.productList||{},e={};for(let t in c){const a=c[t];a.count>0&&(e[t]=a)}return e})),r=(0,n.Fl)((()=>{const c=a[t]?.shopName||[];return c})),i=(0,n.Fl)((()=>{const c=a[t]?.productList,e={total:0,price:0,allChecked:!0};if(c)for(let t in c){const a=c[t];e.total+=a.count,a.check&&(e.price+=a.count*a.price),a.count>0&&!a.check&&(e.allChecked=!1)}return e.price=e.price.toFixed(2),e}));return{changeCartItemInfo:s,cartList:a,productList:o,shopName:r,calculations:i}}},152:function(t,c,a){a.d(c,{Z:function(){return k}});var e=a(3396),n=a(7139);const s={class:"shop"},o=["src"],r={class:"shop__content__title"},i={class:"shop__content__tags"},_={class:"shop__content__tag"},l={class:"shop__content__tag"},d={class:"shop__content__tag"},u={class:"shop__content__highlight"};function p(t,c,a,p,h,m){return(0,e.wg)(),(0,e.iD)("div",s,[(0,e._)("img",{src:a.item.imgUrl,class:"shop__img"},null,8,o),(0,e._)("div",{class:(0,n.C_)({shop__content:!0,"shop__content--bordered":!a.hideBorder})},[(0,e._)("div",r,(0,n.zw)(a.item.name),1),(0,e._)("div",i,[(0,e._)("span",_,"月售："+(0,n.zw)(a.item.sales),1),(0,e._)("span",l,"起送："+(0,n.zw)(a.item.expressLimit),1),(0,e._)("span",d,"基础运费："+(0,n.zw)(a.item.expressPrice),1)]),(0,e._)("p",u,(0,n.zw)(a.item.slogan),1)],2)])}var h={name:"ShopInfo",props:["item","hideBorder"]},m=a(89);const C=(0,m.Z)(h,[["render",p],["__scopeId","data-v-caddef84"]]);var k=C},866:function(t,c,a){a.r(c),a.d(c,{default:function(){return kt}});var e=a(3396),n=a(9242);const s={class:"wrapper"},o={class:"search"};function r(t,c,a,r,i,_){const l=(0,e.up)("ShopInfo"),d=(0,e.up)("Content"),u=(0,e.up)("Cart");return(0,e.wg)(),(0,e.iD)("div",s,[(0,e._)("div",o,[(0,e._)("div",{class:"search__back iconfont",onClick:c[0]||(c[0]=(...t)=>r.handleBackClick&&r.handleBackClick(...t))},"")]),(0,e.wy)((0,e.Wm)(l,{item:r.item,hideBorder:!0},null,8,["item"]),[[n.F8,r.item.imgUrl]]),(0,e.Wm)(d,{shopName:r.item.name},null,8,["shopName"]),(0,e.Wm)(u)])}var i=a(4870),_=a(2483),l=a(60),d=a(152),u=a(7139);const p=t=>((0,e.dD)("data-v-3a3836a5"),t=t(),(0,e.Cn)(),t),h={class:"content"},m={class:"category"},C=["onClick"],k={class:"product"},g=["src"],I={class:"product__item__detail"},v={class:"product__item__title"},w={class:"product__item__sales"},f={class:"product__item__price"},b=p((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),L={class:"product__item__origin"},y={class:"product__number"},z=["onClick"],D=["onClick"];function U(t,c,a,n,s,o){return(0,e.wg)(),(0,e.iD)("div",h,[(0,e._)("div",m,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(n.categories,(t=>((0,e.wg)(),(0,e.iD)("div",{class:(0,u.C_)({category__item:!0,"category__item--active":n.currentTab===t.tab}),key:t.name,onClick:()=>n.handleTabClick(t.tab)},(0,u.zw)(t.name),11,C)))),128))]),(0,e._)("div",k,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(n.list,(t=>((0,e.wg)(),(0,e.iD)("div",{class:"product__item",key:t._id},[(0,e._)("img",{class:"product__item__img",src:`${t.imgUrl}`},null,8,g),(0,e._)("div",I,[(0,e._)("h4",v,(0,u.zw)(t.name),1),(0,e._)("p",w,"月售"+(0,u.zw)(t.sales)+"件",1),(0,e._)("p",f,[b,(0,e.Uk)((0,u.zw)(t.price)+" ",1),(0,e._)("span",L,"¥"+(0,u.zw)(t.oldPrice),1)])]),(0,e._)("div",y,[(0,e._)("span",{class:"product__number__minus iconfont",onClick:()=>{n.changeCartItem(n.shopId,t._id,t,-1,a.shopName)}},"",8,z),(0,e.Uk)(" "+(0,u.zw)(n.getProductCartCount(n.shopId,t._id))+" ",1),(0,e._)("span",{class:"product__number__plus iconfont",onClick:()=>{n.changeCartItem(n.shopId,t._id,t,1,a.shopName)}},"",8,D)])])))),128))])])}var P=a(65),S=a(3229);const T=[{name:"全部商品",tab:"all"},{name:"秒杀",tab:"seckill"},{name:"新鲜水果",tab:"fruit"}],B=()=>{const t=(0,i.iH)(T[0].tab),c=c=>{t.value=c};return{currentTab:t,handleTabClick:c}},H=(t,c)=>{const a=(0,i.qj)({list:[]}),n=async()=>{const e=await(0,l.U2)(`/api/shop/${c}/products`,{tab:t.value});0===e?.errno&&e?.data?.length&&(a.list=e.data)};(0,e.m0)((()=>{n()}));const{list:s}=(0,i.BK)(a);return{list:s}},N=()=>{const t=(0,P.oR)(),{cartList:c,changeCartItemInfo:a}=(0,S.r)(),e=(c,a)=>{t.commit("changeShopName",{shopId:c,shopName:a})},n=(t,c,n,s,o)=>{a(t,c,n,s),e(t,o)},s=(t,a)=>c?.[t]?.productList?.[a]?.count||0;return{cartList:c,changeCartItem:n,getProductCartCount:s}};var F={name:"Content",props:["shopName"],setup(){const t=(0,_.yj)(),c=t.params.id,{currentTab:a,handleTabClick:e}=B(),{list:n}=H(a,c),{changeCartItem:s,cartList:o,getProductCartCount:r}=N();return{list:n,categories:T,currentTab:a,shopId:c,cartList:o,handleTabClick:e,changeCartItem:s,getProductCartCount:r}}},Z=a(89);const j=(0,Z.Z)(F,[["render",U],["__scopeId","data-v-3a3836a5"]]);var x=j;const K=t=>((0,e.dD)("data-v-ee973648"),t=t(),(0,e.Cn)(),t),$={class:"cart"},q={key:0,class:"product"},M={class:"product__header"},W=["innerHTML"],Y={class:"product__header__clear"},R=["innerHTML","onClick"],O=["src"],A={class:"product__item__detail"},E={class:"product__item__title"},G={class:"product__item__price"},J=K((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),Q={class:"product__item__origin"},V={class:"product__number"},X=["onClick"],tt=["onClick"],ct={class:"check"},at={class:"check__icon"},et={class:"check__icon__tag"},nt={class:"check__info"},st={class:"check__info__price"},ot={class:"check__btn"};function rt(t,c,a,s,o,r){const i=(0,e.up)("router-link");return(0,e.wg)(),(0,e.iD)(e.HY,null,[s.showCart&&s.calculations.total>0?((0,e.wg)(),(0,e.iD)("div",{key:0,class:"mask",onClick:c[0]||(c[0]=(...t)=>s.handleCartShowChange&&s.handleCartShowChange(...t))})):(0,e.kq)("",!0),(0,e._)("div",$,[s.showCart&&s.calculations.total>0?((0,e.wg)(),(0,e.iD)("div",q,[(0,e._)("div",M,[(0,e._)("div",{class:"product__header__all",onClick:c[1]||(c[1]=()=>s.setCartItemsChecked(s.shopId))},[(0,e._)("span",{class:"product__header__icon iconfont",innerHTML:s.calculations.allChecked?"":""},null,8,W),(0,e.Uk)(" 全选 ")]),(0,e._)("div",Y,[(0,e._)("span",{class:"product__header__clear_btn",onClick:c[2]||(c[2]=()=>s.cleanCartProducts(s.shopId))},"清空购物车")])]),((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(s.productList,(t=>((0,e.wg)(),(0,e.iD)("div",{key:t._id,class:"product__item"},[(0,e._)("div",{class:"product__item__checked iconfont",innerHTML:t.check?"":"",onClick:()=>s.changeCartItemChecked(s.shopId,t._id)},null,8,R),(0,e._)("img",{class:"product__item__img",src:`${t.imgUrl}`},null,8,O),(0,e._)("div",A,[(0,e._)("h4",E,(0,u.zw)(t.name),1),(0,e._)("p",G,[J,(0,e.Uk)((0,u.zw)(t.price)+" ",1),(0,e._)("span",Q,"¥"+(0,u.zw)(t.oldPrice),1)])]),(0,e._)("div",V,[(0,e._)("span",{class:"product__number__minus iconfont",onClick:()=>{s.changeCartItemInfo(s.shopId,t._id,t,-1)}},"",8,X),(0,e.Uk)(" "+(0,u.zw)(t.count||0)+" ",1),(0,e._)("span",{class:"product__number__plus iconfont",onClick:()=>{s.changeCartItemInfo(s.shopId,t._id,t,1)}},"",8,tt)])])))),128))])):(0,e.kq)("",!0),(0,e._)("div",ct,[(0,e._)("div",at,[(0,e._)("img",{src:"http://www.dell-lee.com/imgs/vue3/basket.png",class:"check__icon__img",onClick:c[3]||(c[3]=(...t)=>s.handleCartShowChange&&s.handleCartShowChange(...t))}),(0,e._)("div",et,(0,u.zw)(s.calculations.total),1)]),(0,e._)("div",nt,[(0,e.Uk)(" 总计："),(0,e._)("span",st,"¥ "+(0,u.zw)(s.calculations.price),1)]),(0,e.wy)((0,e._)("div",ot,[(0,e.Wm)(i,{to:{path:`/OrderConfirmation/${s.shopId}`}},{default:(0,e.w5)((()=>[(0,e.Uk)(" 去结算 ")])),_:1},8,["to"])],512),[[n.F8,s.calculations.total>0]])])])],64)}const it=t=>{const c=(0,P.oR)(),{calculations:a,productList:e,changeCartItemInfo:n}=(0,S.r)(t),s=(t,a)=>{c.commit("changeCartItemChecked",{shopId:t,productId:a})},o=t=>{c.commit("cleanCartProducts",{shopId:t})},r=t=>{c.commit("setCartItemsChecked",{shopId:t})};return{calculations:a,productList:e,changeCartItemInfo:n,changeCartItemChecked:s,cleanCartProducts:o,setCartItemsChecked:r}},_t=()=>{const t=(0,i.iH)(!1),c=()=>{t.value=!t.value};return{showCart:t,handleCartShowChange:c}};var lt={name:"Cart",setup(){const t=(0,_.yj)(),c=t.params.id,{showCart:a,handleCartShowChange:e}=_t(),{calculations:n,productList:s,changeCartItemInfo:o,changeCartItemChecked:r,cleanCartProducts:i,setCartItemsChecked:l}=it(c);return{calculations:n,productList:s,showCart:a,changeCartItemInfo:o,shopId:c,changeCartItemChecked:r,cleanCartProducts:i,setCartItemsChecked:l,handleCartShowChange:e}}};const dt=(0,Z.Z)(lt,[["render",rt],["__scopeId","data-v-ee973648"]]);var ut=dt;const pt=()=>{const t=(0,_.yj)(),c=(0,i.qj)({item:{}}),a=async()=>{const a=await(0,l.U2)(`/api/shop/${t.params.id}`);0===a?.errno&&a?.data&&(c.item=a.data)},{item:e}=(0,i.BK)(c);return{item:e,getItemData:a}},ht=()=>{const t=(0,_.tv)(),c=()=>{t.back()};return{handleBackClick:c}};var mt={name:"Shop",components:{ShopInfo:d.Z,Content:x,Cart:ut},setup(){const{item:t,getItemData:c}=pt(),{handleBackClick:a}=ht();return c(),{item:t,handleBackClick:a}}};const Ct=(0,Z.Z)(mt,[["render",r],["__scopeId","data-v-5dfd4e40"]]);var kt=Ct}}]);
//# sourceMappingURL=shop.b656f91d.js.map