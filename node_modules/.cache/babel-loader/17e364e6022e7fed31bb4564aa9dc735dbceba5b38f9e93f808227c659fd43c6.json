{"ast":null,"code":"import { useStore } from \"vuex\";\nimport { computed } from \"vue\";\n\n//购物车相关逻辑\nexport const useCommonCartEffect = shopId => {\n  const store = useStore();\n  const cartList = store.state.cartList;\n  const changeCartItemInfo = (shopId, productId, productInfo, num) => {\n    store.commit(\"changeCartItemInfo\", {\n      shopId,\n      productId,\n      productInfo,\n      num\n    });\n  };\n  const productList = computed(() => {\n    const productList = cartList[shopId]?.productList || {};\n    console.log(productList);\n    const notEmtyProductList = {};\n    for (let i in productList) {\n      const product = productList[i];\n      if (product.count > 0) {\n        notEmtyProductList[i] = product;\n      }\n    }\n    console.log(notEmtyProductList);\n    return productList;\n  });\n  const shopName = computed(() => {\n    const shopName = cartList[shopId]?.shopName || [];\n    return shopName;\n  });\n  const calculations = computed(() => {\n    const productList = cartList[shopId]?.productList;\n    const result = {\n      total: 0,\n      price: 0,\n      allChecked: true\n    };\n    if (productList) {\n      for (let i in productList) {\n        const product = productList[i];\n        //计算购物车上的件数\n        result.total += product.count;\n        //计算总计价格\n        if (product.check) {\n          result.price += product.count * product.price;\n        }\n        if (product.count > 0 && !product.check) {\n          result.allChecked = false;\n        }\n      }\n    }\n    result.price = result.price.toFixed(2);\n    return result;\n  });\n  return {\n    changeCartItemInfo,\n    cartList,\n    productList,\n    shopName,\n    calculations\n  };\n};","map":{"version":3,"names":["useStore","computed","useCommonCartEffect","shopId","store","cartList","state","changeCartItemInfo","productId","productInfo","num","commit","productList","console","log","notEmtyProductList","i","product","count","shopName","calculations","result","total","price","allChecked","check","toFixed"],"sources":["F:/Web2022/week23-25/shengxian/src/effects/cartEffects.js"],"sourcesContent":["import { useStore } from \"vuex\";\r\nimport { computed } from \"vue\";\r\n\r\n//购物车相关逻辑\r\nexport const useCommonCartEffect = (shopId) => {\r\n    const store = useStore();\r\n    const cartList = store.state.cartList\r\n    const changeCartItemInfo = (shopId, productId, productInfo, num) => {\r\n        store.commit(\"changeCartItemInfo\", {\r\n            shopId,\r\n            productId,\r\n            productInfo,\r\n            num\r\n        });\r\n    };\r\n    const productList = computed(() => {\r\n        const productList = cartList[shopId]?.productList || {};\r\n        console.log(productList)\r\n        const notEmtyProductList = {}\r\n        for (let i in productList) {\r\n            const product = productList[i]\r\n            if (product.count > 0) {\r\n                notEmtyProductList[i] = product\r\n            }\r\n        }\r\n        console.log(notEmtyProductList)\r\n        return productList;\r\n    });\r\n    const shopName = computed(() => {\r\n        const shopName = cartList[shopId]?.shopName || [];\r\n        return shopName;\r\n    });\r\n    const calculations = computed(() => {\r\n        const productList = cartList[shopId]?.productList;\r\n        const result = { total: 0, price: 0, allChecked: true };\r\n        if (productList) {\r\n            for (let i in productList) {\r\n                const product = productList[i];\r\n                //计算购物车上的件数\r\n                result.total += product.count;\r\n                //计算总计价格\r\n                if (product.check) {\r\n                    result.price += product.count * product.price;\r\n                }\r\n                if (product.count > 0 && !product.check) {\r\n                    result.allChecked = false;\r\n                }\r\n            }\r\n        }\r\n        result.price = result.price.toFixed(2);\r\n        return result;\r\n    });\r\n    return { changeCartItemInfo, cartList, productList, shopName, calculations };\r\n};"],"mappings":"AAAA,SAASA,QAAQ,QAAQ,MAAM;AAC/B,SAASC,QAAQ,QAAQ,KAAK;;AAE9B;AACA,OAAO,MAAMC,mBAAmB,GAAIC,MAAM,IAAK;EAC3C,MAAMC,KAAK,GAAGJ,QAAQ,EAAE;EACxB,MAAMK,QAAQ,GAAGD,KAAK,CAACE,KAAK,CAACD,QAAQ;EACrC,MAAME,kBAAkB,GAAGA,CAACJ,MAAM,EAAEK,SAAS,EAAEC,WAAW,EAAEC,GAAG,KAAK;IAChEN,KAAK,CAACO,MAAM,CAAC,oBAAoB,EAAE;MAC/BR,MAAM;MACNK,SAAS;MACTC,WAAW;MACXC;IACJ,CAAC,CAAC;EACN,CAAC;EACD,MAAME,WAAW,GAAGX,QAAQ,CAAC,MAAM;IAC/B,MAAMW,WAAW,GAAGP,QAAQ,CAACF,MAAM,CAAC,EAAES,WAAW,IAAI,CAAC,CAAC;IACvDC,OAAO,CAACC,GAAG,CAACF,WAAW,CAAC;IACxB,MAAMG,kBAAkB,GAAG,CAAC,CAAC;IAC7B,KAAK,IAAIC,CAAC,IAAIJ,WAAW,EAAE;MACvB,MAAMK,OAAO,GAAGL,WAAW,CAACI,CAAC,CAAC;MAC9B,IAAIC,OAAO,CAACC,KAAK,GAAG,CAAC,EAAE;QACnBH,kBAAkB,CAACC,CAAC,CAAC,GAAGC,OAAO;MACnC;IACJ;IACAJ,OAAO,CAACC,GAAG,CAACC,kBAAkB,CAAC;IAC/B,OAAOH,WAAW;EACtB,CAAC,CAAC;EACF,MAAMO,QAAQ,GAAGlB,QAAQ,CAAC,MAAM;IAC5B,MAAMkB,QAAQ,GAAGd,QAAQ,CAACF,MAAM,CAAC,EAAEgB,QAAQ,IAAI,EAAE;IACjD,OAAOA,QAAQ;EACnB,CAAC,CAAC;EACF,MAAMC,YAAY,GAAGnB,QAAQ,CAAC,MAAM;IAChC,MAAMW,WAAW,GAAGP,QAAQ,CAACF,MAAM,CAAC,EAAES,WAAW;IACjD,MAAMS,MAAM,GAAG;MAAEC,KAAK,EAAE,CAAC;MAAEC,KAAK,EAAE,CAAC;MAAEC,UAAU,EAAE;IAAK,CAAC;IACvD,IAAIZ,WAAW,EAAE;MACb,KAAK,IAAII,CAAC,IAAIJ,WAAW,EAAE;QACvB,MAAMK,OAAO,GAAGL,WAAW,CAACI,CAAC,CAAC;QAC9B;QACAK,MAAM,CAACC,KAAK,IAAIL,OAAO,CAACC,KAAK;QAC7B;QACA,IAAID,OAAO,CAACQ,KAAK,EAAE;UACfJ,MAAM,CAACE,KAAK,IAAIN,OAAO,CAACC,KAAK,GAAGD,OAAO,CAACM,KAAK;QACjD;QACA,IAAIN,OAAO,CAACC,KAAK,GAAG,CAAC,IAAI,CAACD,OAAO,CAACQ,KAAK,EAAE;UACrCJ,MAAM,CAACG,UAAU,GAAG,KAAK;QAC7B;MACJ;IACJ;IACAH,MAAM,CAACE,KAAK,GAAGF,MAAM,CAACE,KAAK,CAACG,OAAO,CAAC,CAAC,CAAC;IACtC,OAAOL,MAAM;EACjB,CAAC,CAAC;EACF,OAAO;IAAEd,kBAAkB;IAAEF,QAAQ;IAAEO,WAAW;IAAEO,QAAQ;IAAEC;EAAa,CAAC;AAChF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}